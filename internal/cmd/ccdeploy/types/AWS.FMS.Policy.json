{
    "Arn": "arn:aws:cloudformation:us-east-1::type/resource/AWS-FMS-Policy",
    "Type": "RESOURCE",
    "TypeName": "AWS::FMS::Policy",
    "IsDefaultVersion": true,
    "Description": "Creates an AWS Firewall Manager policy.",
    "Schema": "{\n    \"typeName\": \"AWS::FMS::Policy\",\n    \"description\": \"Creates an AWS Firewall Manager policy.\",\n    \"sourceUrl\": \"https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-fms.git\",\n    \"definitions\": {\n        \"AccountId\": {\n            \"description\": \"An AWS account ID.\",\n            \"type\": \"string\",\n            \"pattern\": \"^([0-9]*)$\",\n            \"minLength\": 12,\n            \"maxLength\": 12\n        },\n        \"Base62Id\": {\n            \"description\": \"A Base62 ID\",\n            \"type\": \"string\",\n            \"pattern\": \"^[a-z0-9A-Z]{22}$\",\n            \"minLength\": 22,\n            \"maxLength\": 22\n        },\n        \"OrganizationalUnitId\": {\n            \"description\": \"An Organizational Unit ID.\",\n            \"type\": \"string\",\n            \"pattern\": \"^(ou-[0-9a-z]{4,32}-[a-z0-9]{8,32})$\",\n            \"minLength\": 16,\n            \"maxLength\": 68\n        },\n        \"IEMap\": {\n            \"description\": \"An FMS includeMap or excludeMap.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"ACCOUNT\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/definitions/AccountId\"\n                    },\n                    \"insertionOrder\": true\n                },\n                \"ORGUNIT\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"$ref\": \"#/definitions/OrganizationalUnitId\"\n                    },\n                    \"insertionOrder\": true\n                }\n            },\n            \"additionalProperties\": false\n        },\n        \"PolicyTag\": {\n            \"description\": \"A policy tag.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"Key\": {\n                    \"type\": \"string\",\n                    \"pattern\": \"^([^\\\\s]*)$\",\n                    \"minLength\": 1,\n                    \"maxLength\": 128\n                },\n                \"Value\": {\n                    \"type\": \"string\",\n                    \"pattern\": \"^([^\\\\s]*)$\",\n                    \"maxLength\": 256\n                }\n            },\n            \"additionalProperties\": false,\n            \"required\": [\n                \"Key\",\n                \"Value\"\n            ]\n        },\n        \"ResourceTag\": {\n            \"description\": \"A resource tag.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"Key\": {\n                    \"type\": \"string\",\n                    \"minLength\": 1,\n                    \"maxLength\": 128\n                },\n                \"Value\": {\n                    \"type\": \"string\",\n                    \"maxLength\": 256\n                }\n            },\n            \"additionalProperties\": false,\n            \"required\": [\n                \"Key\"\n            ]\n        },\n        \"ResourceType\": {\n            \"description\": \"An AWS resource type\",\n            \"type\": \"string\",\n            \"pattern\": \"^([^\\\\s]*)$\",\n            \"minLength\": 1,\n            \"maxLength\": 128\n        },\n        \"ResourceArn\": {\n            \"description\": \"A resource ARN.\",\n            \"type\": \"string\",\n            \"pattern\": \"^([^\\\\s]*)$\",\n            \"minLength\": 1,\n            \"maxLength\": 1024\n        },\n        \"SecurityServicePolicyData\": {\n            \"description\": \"Firewall security service policy data.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"ManagedServiceData\": {\n                    \"$ref\": \"#/definitions/ManagedServiceData\"\n                },\n                \"Type\": {\n                    \"$ref\": \"#/definitions/PolicyType\"\n                },\n                \"PolicyOption\": {\n                    \"$ref\": \"#/definitions/PolicyOption\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"required\": [\n                \"Type\"\n            ]\n        },\n        \"FirewallDeploymentModel\": {\n            \"description\": \"Firewall deployment mode.\",\n            \"type\": \"string\",\n            \"enum\": [\n                \"DISTRIBUTED\",\n                \"CENTRALIZED\"\n            ]\n        },\n        \"ManagedServiceData\": {\n            \"description\": \"Firewall managed service data.\",\n            \"type\": \"string\",\n            \"minLength\": 1,\n            \"maxLength\": 8192\n        },\n        \"PolicyType\": {\n            \"description\": \"Firewall policy type.\",\n            \"type\": \"string\",\n            \"enum\": [\n                \"WAF\",\n                \"WAFV2\",\n                \"SHIELD_ADVANCED\",\n                \"SECURITY_GROUPS_COMMON\",\n                \"SECURITY_GROUPS_CONTENT_AUDIT\",\n                \"SECURITY_GROUPS_USAGE_AUDIT\",\n                \"NETWORK_FIREWALL\",\n                \"THIRD_PARTY_FIREWALL\",\n                \"DNS_FIREWALL\",\n                \"IMPORT_NETWORK_FIREWALL\"\n            ]\n        },\n        \"NetworkFirewallPolicy\": {\n            \"description\": \"Network firewall policy.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"FirewallDeploymentModel\": {\n                    \"$ref\": \"#/definitions/FirewallDeploymentModel\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"required\": [\n                \"FirewallDeploymentModel\"\n            ]\n        },\n        \"ThirdPartyFirewallPolicy\": {\n            \"description\": \"Third party firewall policy.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"FirewallDeploymentModel\": {\n                    \"$ref\": \"#/definitions/FirewallDeploymentModel\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"required\": [\n                \"FirewallDeploymentModel\"\n            ]\n        },\n        \"PolicyOption\": {\n            \"description\": \"Firewall policy option.\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"NetworkFirewallPolicy\": {\n                    \"$ref\": \"#/definitions/NetworkFirewallPolicy\"\n                },\n                \"ThirdPartyFirewallPolicy\": {\n                    \"$ref\": \"#/definitions/ThirdPartyFirewallPolicy\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"oneOf\": [\n                {\n                    \"required\": [\n                        \"NetworkFirewallPolicy\"\n                    ]\n                },\n                {\n                    \"required\": [\n                        \"ThirdPartyFirewallPolicy\"\n                    ]\n                }\n            ]\n        }\n    },\n    \"properties\": {\n        \"ExcludeMap\": {\n            \"$ref\": \"#/definitions/IEMap\"\n        },\n        \"ExcludeResourceTags\": {\n            \"type\": \"boolean\"\n        },\n        \"IncludeMap\": {\n            \"$ref\": \"#/definitions/IEMap\"\n        },\n        \"Id\": {\n            \"type\": \"string\",\n            \"pattern\": \"^[a-z0-9A-Z-]{36}$\",\n            \"minLength\": 36,\n            \"maxLength\": 36\n        },\n        \"PolicyName\": {\n            \"type\": \"string\",\n            \"pattern\": \"^([a-zA-Z0-9_.:/=+\\\\-@\\\\s]+)$\",\n            \"minLength\": 1,\n            \"maxLength\": 1024\n        },\n        \"PolicyDescription\": {\n            \"type\": \"string\",\n            \"pattern\": \"^([a-zA-Z0-9_.:/=+\\\\-@\\\\s]+)$\",\n            \"maxLength\": 256\n        },\n        \"RemediationEnabled\": {\n            \"type\": \"boolean\"\n        },\n        \"ResourceTags\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"$ref\": \"#/definitions/ResourceTag\"\n            },\n            \"maxItems\": 8,\n            \"insertionOrder\": true\n        },\n        \"ResourceType\": {\n            \"$ref\": \"#/definitions/ResourceType\"\n        },\n        \"ResourceTypeList\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"$ref\": \"#/definitions/ResourceType\"\n            },\n            \"insertionOrder\": true\n        },\n        \"ResourceSetIds\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"$ref\": \"#/definitions/Base62Id\"\n            },\n            \"insertionOrder\": true,\n            \"uniqueItems\": true\n        },\n        \"SecurityServicePolicyData\": {\n            \"$ref\": \"#/definitions/SecurityServicePolicyData\"\n        },\n        \"Arn\": {\n            \"$ref\": \"#/definitions/ResourceArn\"\n        },\n        \"DeleteAllPolicyResources\": {\n            \"type\": \"boolean\"\n        },\n        \"ResourcesCleanUp\": {\n            \"type\": \"boolean\"\n        },\n        \"Tags\": {\n            \"type\": \"array\",\n            \"items\": {\n                \"$ref\": \"#/definitions/PolicyTag\"\n            },\n            \"insertionOrder\": true\n        }\n    },\n    \"additionalProperties\": false,\n    \"required\": [\n        \"ExcludeResourceTags\",\n        \"PolicyName\",\n        \"RemediationEnabled\",\n        \"SecurityServicePolicyData\"\n    ],\n    \"readOnlyProperties\": [\n        \"/properties/Arn\",\n        \"/properties/Id\"\n    ],\n    \"writeOnlyProperties\": [\n        \"/properties/DeleteAllPolicyResources\"\n    ],\n    \"primaryIdentifier\": [\n        \"/properties/Id\"\n    ],\n    \"handlers\": {\n        \"create\": {\n            \"permissions\": [\n                \"fms:PutPolicy\",\n                \"fms:TagResource\",\n                \"waf-regional:ListRuleGroups\",\n                \"wafv2:CheckCapacity\",\n                \"wafv2:ListRuleGroups\",\n                \"wafv2:ListAvailableManagedRuleGroups\",\n                \"wafv2:ListAvailableManagedRuleGroupVersions\",\n                \"network-firewall:DescribeRuleGroup\",\n                \"network-firewall:DescribeRuleGroupMetadata\",\n                \"route53resolver:ListFirewallRuleGroups\",\n                \"ec2:DescribeAvailabilityZones\",\n                \"s3:PutBucketPolicy\",\n                \"s3:GetBucketPolicy\"\n            ]\n        },\n        \"update\": {\n            \"permissions\": [\n                \"fms:PutPolicy\",\n                \"fms:GetPolicy\",\n                \"fms:TagResource\",\n                \"fms:UntagResource\",\n                \"fms:ListTagsForResource\",\n                \"waf-regional:ListRuleGroups\",\n                \"wafv2:CheckCapacity\",\n                \"wafv2:ListRuleGroups\",\n                \"wafv2:ListAvailableManagedRuleGroups\",\n                \"wafv2:ListAvailableManagedRuleGroupVersions\",\n                \"network-firewall:DescribeRuleGroup\",\n                \"network-firewall:DescribeRuleGroupMetadata\",\n                \"route53resolver:ListFirewallRuleGroups\",\n                \"ec2:DescribeAvailabilityZones\",\n                \"s3:PutBucketPolicy\",\n                \"s3:GetBucketPolicy\"\n            ]\n        },\n        \"read\": {\n            \"permissions\": [\n                \"fms:GetPolicy\",\n                \"fms:ListTagsForResource\"\n            ]\n        },\n        \"delete\": {\n            \"permissions\": [\n                \"fms:DeletePolicy\"\n            ]\n        },\n        \"list\": {\n            \"permissions\": [\n                \"fms:ListPolicies\",\n                \"fms:ListTagsForResource\"\n            ]\n        }\n    }\n}",
    "ProvisioningType": "FULLY_MUTABLE",
    "DeprecatedStatus": "LIVE",
    "Visibility": "PUBLIC",
    "SourceUrl": "https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-fms.git",
    "TimeCreated": "2020-02-05T00:44:46.837000+00:00"
}
