/// AWS::IoT::SecurityProfile
///
/// Generated by rain build --pkl-class AWS::IoT::SecurityProfile
module aws.iot.securityprofile

import "../../cloudformation.pkl"

/// A structure containing the alert target ARN and the role ARN.
open class SecurityProfileAlertTarget {
    AlertTargetArn: String|Mapping
    RoleArn: String|Mapping
}

typealias BehaviorCriteriaComparisonOperator = "less-than"|"less-than-equals"|"greater-than"|"greater-than-equals"|"in-cidr-set"|"not-in-cidr-set"|"in-port-set"|"not-in-port-set"|"in-set"|"not-in-set"

/// The criteria by which the behavior is determined to be normal.
open class SecurityProfileBehaviorCriteria {
    ComparisonOperator: (BehaviorCriteriaComparisonOperator|Mapping)?
    Value: (SecurityProfileMetricValue)?
    DurationSeconds: (Int|Mapping)?
    ConsecutiveDatapointsToAlarm: (Int|Mapping)?
    ConsecutiveDatapointsToClear: (Int|Mapping)?
    StatisticalThreshold: (SecurityProfileStatisticalThreshold)?
    MlDetectionConfig: (SecurityProfileMachineLearningDetectionConfig)?
}

/// A security profile behavior.
open class SecurityProfileBehavior {
    MetricDimension: (SecurityProfileMetricDimension)?
    Criteria: (SecurityProfileBehaviorCriteria)?
    SuppressAlerts: (Boolean|Mapping)?
    ExportMetric: (SecurityProfileExportMetric)?
    Name: String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping
    Metric: (String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping)?
}

typealias MetricDimensionOperator = "IN"|"NOT_IN"

/// The dimension of a metric.
open class SecurityProfileMetricDimension {
    DimensionName: String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping
    Operator: (MetricDimensionOperator|Mapping)?
}

typealias MachineLearningDetectionConfigConfidenceLevel = "LOW"|"MEDIUM"|"HIGH"

/// The configuration of an ML Detect Security Profile.
open class SecurityProfileMachineLearningDetectionConfig {
    ConfidenceLevel: (MachineLearningDetectionConfigConfidenceLevel|Mapping)?
}

/// A key-value pair to associate with a resource.
open class SecurityProfileTag {
    Key: String|Mapping
    Value: String|Mapping
}
