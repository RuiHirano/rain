/// AWS::SecurityHub::AutomationRule
///
/// Generated by rain build --pkl-class AWS::SecurityHub::AutomationRule
module aws.securityhub.automationrule

import "../../cloudformation.pkl"

/// Provides details about a list of findings that the current finding relates to.
open class AutomationRuleRelatedFinding {
    Id: AutomationRulearnOrId
    ProductArn: AutomationRulearn
}

typealias AutomationRulesFindingFieldsUpdateVerificationState = "UNKNOWN"|"TRUE_POSITIVE"|"FALSE_POSITIVE"|"BENIGN_POSITIVE"

/// The rule action will update the ``Note`` field of a finding.
open class AutomationRuleAutomationRulesFindingFieldsUpdate {
    Criticality: (AutomationRuleint100)?
    VerificationState: (AutomationRulesFindingFieldsUpdateVerificationState|Mapping)?
    RelatedFindings: (Listing<AutomationRuleRelatedFinding>)?
    Note: (Dynamic)?
    Workflow: (Dynamic)?
    Types: (Listing<String|Mapping>)?
    Severity: (Dynamic)?
    Confidence: (AutomationRuleint100)?
    UserDefinedFields: (AutomationRulemap)?
}

typealias AutomationRuleISO8601DateString = String|Mapping


/// 
open class AutomationRuleDateFilter {
    End: (AutomationRuleISO8601DateString)?
    Start: (AutomationRuleISO8601DateString)?
    DateRange: (AutomationRuleDateRange)?
}

/// 
open class AutomationRuleAutomationRulesFindingFilters {
    AwsAccountId: (Listing<AutomationRuleStringFilter>)?
    Confidence: (Listing<AutomationRuleNumberFilter>)?
    ResourceDetailsOther: (Listing<AutomationRuleMapFilter>)?
    VerificationState: (Listing<AutomationRuleStringFilter>)?
    Description: (Listing<AutomationRuleStringFilter>)?
    RelatedFindingsProductArn: (Listing<AutomationRuleStringFilter>)?
    RelatedFindingsId: (Listing<AutomationRuleStringFilter>)?
    Id: (Listing<AutomationRuleStringFilter>)?
    UpdatedAt: (Listing<AutomationRuleDateFilter>)?
    Title: (Listing<AutomationRuleStringFilter>)?
    ResourceTags: (Listing<AutomationRuleMapFilter>)?
    ResourceRegion: (Listing<AutomationRuleStringFilter>)?
    WorkflowStatus: (Listing<AutomationRuleStringFilter>)?
    NoteText: (Listing<AutomationRuleStringFilter>)?
    GeneratorId: (Listing<AutomationRuleStringFilter>)?
    Type: (Listing<AutomationRuleStringFilter>)?
    Criticality: (Listing<AutomationRuleNumberFilter>)?
    ProductName: (Listing<AutomationRuleStringFilter>)?
    SeverityLabel: (Listing<AutomationRuleStringFilter>)?
    UserDefinedFields: (Listing<AutomationRuleMapFilter>)?
    ProductArn: (Listing<AutomationRuleStringFilter>)?
    SourceUrl: (Listing<AutomationRuleStringFilter>)?
    ComplianceStatus: (Listing<AutomationRuleStringFilter>)?
    ComplianceSecurityControlId: (Listing<AutomationRuleStringFilter>)?
    NoteUpdatedAt: (Listing<AutomationRuleDateFilter>)?
    FirstObservedAt: (Listing<AutomationRuleDateFilter>)?
    LastObservedAt: (Listing<AutomationRuleDateFilter>)?
    ResourceType: (Listing<AutomationRuleStringFilter>)?
    ResourcePartition: (Listing<AutomationRuleStringFilter>)?
    CompanyName: (Listing<AutomationRuleStringFilter>)?
    ResourceId: (Listing<AutomationRuleStringFilter>)?
    ComplianceAssociatedStandardsId: (Listing<AutomationRuleStringFilter>)?
    CreatedAt: (Listing<AutomationRuleDateFilter>)?
    RecordState: (Listing<AutomationRuleStringFilter>)?
    NoteUpdatedBy: (Listing<AutomationRuleStringFilter>)?
}

/// 
open class AutomationRuleNumberFilter {
    Eq: (Number|Mapping)?
    Gte: (Number|Mapping)?
    Lte: (Number|Mapping)?
}

typealias AutomationRulearnOrId1 = AutomationRulearn


typealias AutomationRuletimestamp = String|Mapping


/// 
open class AutomationRuleNoteUpdate {
    Text: String|Mapping
    UpdatedBy: AutomationRulearnOrId
}

typealias AutomationRuleint100 = Int|Mapping


typealias WorkflowUpdateStatus = "NEW"|"NOTIFIED"|"RESOLVED"|"SUPPRESSED"

/// 
open class AutomationRuleWorkflowUpdate {
    Status: WorkflowUpdateStatus|Mapping
}

typealias DateRangeUnit = "DAYS"

/// 
open class AutomationRuleDateRange {
    Unit: DateRangeUnit|Mapping
    Value: Number|Mapping
}

typealias AutomationRulearn = String|Mapping


typealias AutomationRulesActionType = "FINDING_FIELDS_UPDATE"

/// 
open class AutomationRuleAutomationRulesAction {
    Type: AutomationRulesActionType|Mapping
    FindingFieldsUpdate: AutomationRuleAutomationRulesFindingFieldsUpdate
}

typealias AutomationRuleStringFilterComparison = String|Mapping


typealias AutomationRulearnOrId = AutomationRulearnOrId0|AutomationRulearnOrId1


typealias AutomationRulearnOrId0 = String|Mapping


/// 
open class AutomationRuleBooleanFilter {
    Value: Boolean|Mapping
}

typealias AutomationRulemap = Mapping<String, Any>


typealias AutomationRuleTags = Mapping<String, Any>


typealias AutomationRuleNonEmptyString = String|Mapping


typealias MapFilterComparison = "EQUALS"|"NOT_EQUALS"|"CONTAINS"|"NOT_CONTAINS"

/// 
open class AutomationRuleMapFilter {
    Key: String|Mapping
    Value: String|Mapping
    Comparison: MapFilterComparison|Mapping
}

/// 
open class AutomationRuleStringFilter {
    Comparison: AutomationRuleStringFilterComparison
    Value: String|Mapping
}

typealias SeverityUpdateLabel = "INFORMATIONAL"|"LOW"|"MEDIUM"|"HIGH"|"CRITICAL"

/// 
open class AutomationRuleSeverityUpdate {
    Product: (Number|Mapping)?
    Label: (SeverityUpdateLabel|Mapping)?
    Normalized: (AutomationRuleint100)?
}

/// The ``AWS::SecurityHub::AutomationRule`` resource specifies an automation rule based on input parameters. For more information, see [Automation rules](https://docs.aws.amazon.com/securityhub/latest/userguide/automation-rules.html) in the *User Guide*.
open class AutomationRule extends cloudformation.Resource {

    Type = "AWS::SecurityHub::AutomationRule"


    /// 
    hidden RuleOrder: (Int|Mapping)?

    /// 
    hidden RuleName: (String|Mapping)?

    /// 
    hidden IsTerminal: (Boolean|Mapping)?

    /// A set of [Security Finding Format (ASFF)](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-findings-format.html) finding field attributes and corresponding expected values that ASH uses to filter findings. If a rule is enabled and a finding matches the criteria specified in this parameter, ASH applies the rule action to the finding.
    hidden Criteria: (AutomationRuleAutomationRulesFindingFilters)?

    /// 
    hidden Tags: (AutomationRuleTags)?

    /// Whether the rule is active after it is created. If this parameter is equal to ``ENABLED``, ASH applies the rule to findings and finding updates after the rule is created.
    hidden RuleStatus: (AutomationRuleRuleStatus|Mapping)?

    /// 
    hidden Description: (String|Mapping)?

    /// 
    hidden Actions: (Listing<AutomationRuleAutomationRulesAction>)?

    Properties {
        ["RuleOrder"] = if (RuleOrder == null) null else RuleOrder
        ["RuleName"] = if (RuleName == null) null else RuleName
        ["IsTerminal"] = if (IsTerminal == null) null else IsTerminal
        ["Criteria"] = if (Criteria == null) null else Criteria
        ["Tags"] = if (Tags == null) null else Tags
        ["RuleStatus"] = if (RuleStatus == null) null else RuleStatus
        ["Description"] = if (Description == null) null else Description
        ["Actions"] = if (Actions == null) null else Actions
    }

}


typealias AutomationRuleRuleStatus = "ENABLED"|"DISABLED"
